{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Gary\\\\Documents\\\\Git\\\\KiasuGrocer\\\\kiasu_grocer\\\\src\\\\pages\\\\Dashboard.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Navbar from \"../components/Navbar\";\nimport Hero from \"../components/Hero\";\nimport ItemView from \"../components/ItemView\";\nimport { listOfItems } from \"../data/item_list\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  const [vendorDetails, setVendorDetails] = useState([]);\n  //*************FROM HERE ARE TO BE ADDED*****************\n  const calcDistance = (lat1, lon1, lat2, lon2) => {\n    var R = 6371; // Radius of the earth in km\n    var degLat = degToRad(lat2 - lat1); // deg2rad below\n    var degLon = degToRad(lon2 - lon1);\n    var a = Math.sin(degLat / 2) * Math.sin(degLat / 2) + Math.cos(degToRad(lat1)) * Math.cos(degToRad(lat2)) * Math.sin(degLon / 2) * Math.sin(degLon / 2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    var d = R * c; // Distance in km\n    return d;\n  };\n  function degToRad(deg) {\n    return deg * (Math.PI / 180);\n  }\n  const RESTresponse = () => {\n    var requestOptions = {\n      method: 'GET',\n      redirect: 'follow'\n    };\n    let markets = fetch(\"https://data.gov.sg/api/action/datastore_search?resource_id=df586152-d00f-4b15-b667-9e268f1b60df&limit=5\", requestOptions).then(response => response.json()).then(result => result.result.records).then(x => {\n      return x.map(element => {\n        return fetch(\"http://api.positionstack.com/v1/forward?access_key=77dd088611e15e988f32434bfe65a3db&query=\" + element.premise_address, requestOptions).then(response => response.json()).then(result => [result.data[0].name, result.data[0].latitude, result.data[0].longitude, element.business_name]);\n      });\n    });\n    return markets;\n  };\n  const fetchData = () => {\n    var list = [];\n    const handleGeolocationSuccess = position => {\n      const {\n        latitude,\n        longitude\n      } = position.coords;\n      RESTresponse().then(element => element.map(promise => promise.then(x => [x[0], calcDistance(latitude, longitude, x[1], x[2]), x[3]])).filter(promise => promise.then(x => x[1] < 3))).then(fList => console.log(fList));\n    };\n    const handleGeolocationError = error => {\n      console.log(\"Geolocation error:\", error);\n    };\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(handleGeolocationSuccess, handleGeolocationError);\n    } else {\n      console.log(\"Geolocation is not supported by this browser.\");\n    }\n    return list;\n  };\n  const navigate = useNavigate();\n  const [itemList, setItemList] = useState(listOfItems);\n  const goToAuthCustomer = async () => await navigate('/authcustomer');\n  useEffect(() => {\n    setVendorDetails(Promise.allSettled(fetchData));\n    var listOf3ARR = vendorDetails.map((values, index) => values.then());\n    console.log(\"vendor details:\" + vendorDetails);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\",\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Hero, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this), itemList.map((values, index) => {\n      return /*#__PURE__*/_jsxDEV(ItemView, {\n        data: values,\n        handleClick: goToAuthCustomer\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 20\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 12\n  }, this);\n};\n_s(Dashboard, \"ipwAsaqFYmVmSMaRxarEx+8yn88=\", false, function () {\n  return [useNavigate];\n});\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","Navbar","Hero","ItemView","listOfItems","useNavigate","jsxDEV","_jsxDEV","Dashboard","_s","vendorDetails","setVendorDetails","calcDistance","lat1","lon1","lat2","lon2","R","degLat","degToRad","degLon","a","Math","sin","cos","c","atan2","sqrt","d","deg","PI","RESTresponse","requestOptions","method","redirect","markets","fetch","then","response","json","result","records","x","map","element","premise_address","data","name","latitude","longitude","business_name","fetchData","list","handleGeolocationSuccess","position","coords","promise","filter","fList","console","log","handleGeolocationError","error","navigator","geolocation","getCurrentPosition","navigate","itemList","setItemList","goToAuthCustomer","Promise","allSettled","listOf3ARR","values","index","className","children","fileName","_jsxFileName","lineNumber","columnNumber","handleClick","_c","$RefreshReg$"],"sources":["C:/Users/Gary/Documents/Git/KiasuGrocer/kiasu_grocer/src/pages/Dashboard.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport Hero from \"../components/Hero\";\r\nimport ItemView from \"../components/ItemView\";\r\nimport { listOfItems } from \"../data/item_list\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\n\r\nconst Dashboard = () => {\r\n    const [vendorDetails, setVendorDetails] = useState([]);\r\n    //*************FROM HERE ARE TO BE ADDED*****************\r\n    const calcDistance = (lat1, lon1, lat2, lon2) => {\r\n        var R = 6371; // Radius of the earth in km\r\n        var degLat = degToRad(lat2-lat1);  // deg2rad below\r\n        var degLon = degToRad(lon2-lon1); \r\n        var a = Math.sin(degLat/2) * Math.sin(degLat/2) +\r\n                Math.cos(degToRad(lat1)) * Math.cos(degToRad(lat2)) * \r\n                Math.sin(degLon/2) * Math.sin(degLon/2); \r\n        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \r\n        var d = R * c; // Distance in km\r\n        return d;\r\n    }\r\n\r\n    function degToRad(deg) {\r\n        return deg * (Math.PI/180)\r\n    }\r\n\r\n    const RESTresponse = () => {\r\n        var requestOptions = {\r\n            method: 'GET',\r\n            redirect: 'follow'\r\n          };\r\n\r\n        let markets = fetch(\"https://data.gov.sg/api/action/datastore_search?resource_id=df586152-d00f-4b15-b667-9e268f1b60df&limit=5\", requestOptions)\r\n                        .then(response => response.json())\r\n                        .then(result => result.result.records)\r\n                        .then(x => {\r\n                            return x.map(element => {\r\n                                return fetch(\"http://api.positionstack.com/v1/forward?access_key=77dd088611e15e988f32434bfe65a3db&query=\" + element.premise_address, requestOptions)\r\n                                    .then(response => response.json())\r\n                                    .then(result => [result.data[0].name, result.data[0].latitude, result.data[0].longitude, element.business_name])\r\n                            });\r\n                        });\r\n        return markets;\r\n    }\r\n\r\n    const fetchData = () => {\r\n        var list = []\r\n        const handleGeolocationSuccess = (position) => {\r\n            const { latitude, longitude } = position.coords;\r\n            RESTresponse().then(element => \r\n                element.map(promise => promise.then(x => [x[0], calcDistance(latitude, longitude, x[1], x[2]), x[3]]))\r\n                    .filter(promise => promise.then(x => x[1] < 3)))\r\n            .then(fList => console.log(fList));\r\n        };\r\n        \r\n        const handleGeolocationError = (error) => {\r\n           console.log(\"Geolocation error:\", error);\r\n        };\r\n\r\n        if (navigator.geolocation) {\r\n            navigator.geolocation.getCurrentPosition(\r\n              handleGeolocationSuccess,\r\n              handleGeolocationError\r\n            );\r\n        } else {\r\n            console.log(\"Geolocation is not supported by this browser.\");\r\n        }\r\n        return list;\r\n    }\r\n\r\n\r\n    const navigate = useNavigate();\r\n    const [itemList,setItemList] = useState(listOfItems);\r\n    const goToAuthCustomer = async () => await navigate('/authcustomer');\r\n\r\n    useEffect(() => {\r\n        setVendorDetails(Promise.allSettled(fetchData));\r\n        var listOf3ARR = vendorDetails.map((values,index) => values.then())\r\n        console.log(\"vendor details:\" + vendorDetails);\r\n    }, [])\r\n\r\n    return <div className=\"\">\r\n        <Navbar/>\r\n        <Hero />\r\n        {itemList.map((values,index) => {\r\n            return <ItemView data={values} handleClick = {goToAuthCustomer} />\r\n        })}\r\n    </div>\r\n}\r\n\r\nexport default Dashboard;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}